<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>53.0</apiVersion>
    <decisions>
        <name>Bonus_Natura_Decision</name>
        <label>Bonus Natura Decision</label>
        <locationX>710</locationX>
        <locationY>1334</locationY>
        <defaultConnector>
            <targetReference>Servizio_Decision_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isNotBonusNatura</defaultConnectorLabel>
        <rules>
            <name>isBonusNatura</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Bonus_Loop.Product2.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Bonus Natura</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Condizioni_Economiche_Bonus</targetReference>
            </connector>
            <label>isBonusNatura</label>
        </rules>
    </decisions>
    <decisions>
        <name>Bonus_Natura_Decision_0</name>
        <label>Bonus Natura Decision</label>
        <locationX>1590</locationX>
        <locationY>1334</locationY>
        <defaultConnector>
            <targetReference>Servizio_Decision_0_0_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isNotBonusNatura</defaultConnectorLabel>
        <rules>
            <name>isBonusNatura_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Bonus_Loop_0.Product2.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Bonus Natura</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Condizioni_Economiche_Bonus_0</targetReference>
            </connector>
            <label>isBonusNatura</label>
        </rules>
    </decisions>
    <decisions>
        <name>Categoria_Cliente_Decision</name>
        <label>Categoria Cliente Decision</label>
        <locationX>490</locationX>
        <locationY>518</locationY>
        <defaultConnector>
            <targetReference>LoopOrdiniFigliOfferta_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isAziende</defaultConnectorLabel>
        <rules>
            <name>isFamiglie</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput.CustomerCategory__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Famiglie</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>LoopOrdiniFigliOfferta</targetReference>
            </connector>
            <label>isFamiglie</label>
        </rules>
    </decisions>
    <decisions>
        <name>Servizio_Decision</name>
        <label>Servizio Decision</label>
        <locationX>490</locationX>
        <locationY>758</locationY>
        <defaultConnector>
            <targetReference>Condizioni_Economiche_Famiglie_GAS</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isGAS</defaultConnectorLabel>
        <rules>
            <name>isEE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LoopOrdiniFigliOfferta.CommodityFormula__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Energia Elettrica</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Condizioni_Economiche_Famiglie_EE</targetReference>
            </connector>
            <label>isEE</label>
        </rules>
    </decisions>
    <decisions>
        <name>Servizio_Decision_0</name>
        <label>Servizio Decision</label>
        <locationX>710</locationX>
        <locationY>1670</locationY>
        <defaultConnector>
            <targetReference>Dati_Tecnici_Famiglie_GAS</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isGAS</defaultConnectorLabel>
        <rules>
            <name>isEE_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LoopOrdiniFigliOfferta.CommodityFormula__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Energia Elettrica</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Dati_Tecnici_Famiglie_EE</targetReference>
            </connector>
            <label>isEE</label>
        </rules>
    </decisions>
    <decisions>
        <name>Servizio_Decision_0_0</name>
        <label>Servizio Decision</label>
        <locationX>1370</locationX>
        <locationY>758</locationY>
        <defaultConnector>
            <targetReference>Condizioni_Economiche_Aziende_GAS</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isGAS</defaultConnectorLabel>
        <rules>
            <name>isEE_0_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LoopOrdiniFigliOfferta_0.CommodityFormula__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Energia Elettrica</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Condizioni_Economiche_Aziende_EE_0</targetReference>
            </connector>
            <label>isEE</label>
        </rules>
    </decisions>
    <decisions>
        <name>Servizio_Decision_0_0_0</name>
        <label>Servizio Decision</label>
        <locationX>1590</locationX>
        <locationY>1670</locationY>
        <defaultConnector>
            <targetReference>Dati_Tecnici_Aziende_GAS</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isGAS</defaultConnectorLabel>
        <rules>
            <name>isEE_0_0_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>LoopOrdiniFigliOfferta_0.CommodityFormula__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Energia Elettrica</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Dati_Tecnici_Aziende_EE</targetReference>
            </connector>
            <label>isEE</label>
        </rules>
    </decisions>
    <interviewLabel>HDL {!$Flow.CurrentDateTime}</interviewLabel>
    <label>HDL FL VO Script - Prezzo Fisso Leggero</label>
    <loops>
        <name>Bonus_Loop</name>
        <label>Bonus Loop</label>
        <locationX>490</locationX>
        <locationY>1214</locationY>
        <collectionReference>GetOrderItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Bonus_Natura_Decision</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>LoopOrdiniFigliOfferta</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Bonus_Loop_0</name>
        <label>Bonus Loop</label>
        <locationX>1370</locationX>
        <locationY>1214</locationY>
        <collectionReference>GetOrderItems_0</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Bonus_Natura_Decision_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>LoopOrdiniFigliOfferta_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LoopOrdiniFigliOfferta</name>
        <label>LoopOrdiniFigliOfferta</label>
        <locationX>50</locationX>
        <locationY>638</locationY>
        <collectionReference>HDT_FL_Script_Gestione_Ordini.AssignOrdiniFigliOutput</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Servizio_Decision</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Order_Items_Vas_Loop</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LoopOrdiniFigliOfferta_0</name>
        <label>LoopOrdiniFigliOfferta</label>
        <locationX>930</locationX>
        <locationY>638</locationY>
        <collectionReference>HDT_FL_Script_Gestione_Ordini.AssignOrdiniFigliOutput</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Servizio_Decision_0_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Order_Items_Vas_Loop</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Order_Items_Vas_Loop</name>
        <label>Order Items Vas Loop</label>
        <locationX>490</locationX>
        <locationY>2294</locationY>
        <collectionReference>HDT_FL_Script_Gestione_Ordini.AssignOrdiniFigliVASBonusOutput</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>HDT_Script_VAS</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Durata_Contratto</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>GetOrderItems</name>
        <label>GetOrderItems</label>
        <locationX>490</locationX>
        <locationY>1094</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Bonus_Loop</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>LoopOrdiniFigliOfferta.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetOrderItems_0</name>
        <label>GetOrderItems</label>
        <locationX>1370</locationX>
        <locationY>1094</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Bonus_Loop_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>LoopOrdiniFigliOfferta_0.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <screens>
        <name>Condizioni_Economiche_Aziende_EE_0</name>
        <label>Condizioni Economiche Aziende EE</label>
        <locationX>1238</locationX>
        <locationY>878</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>GetOrderItems_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Condizioni_Economiche_Aziende_GAS</name>
        <label>Condizioni Economiche Aziende GAS</label>
        <locationX>1502</locationX>
        <locationY>878</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>GetOrderItems_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Condizioni_Economiche_Bonus</name>
        <label>Condizioni Economiche Bonus</label>
        <locationX>578</locationX>
        <locationY>1454</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Servizio_Decision_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Condizioni_Economiche_Bonus_0</name>
        <label>Condizioni Economiche Bonus</label>
        <locationX>1458</locationX>
        <locationY>1454</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Servizio_Decision_0_0_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Condizioni_Economiche_Famiglie_EE</name>
        <label>Condizioni Economiche Famiglie EE</label>
        <locationX>358</locationX>
        <locationY>878</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>GetOrderItems</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Condizioni_Economiche_Famiglie_GAS</name>
        <label>Condizioni Economiche Famiglie GAS</label>
        <locationX>622</locationX>
        <locationY>878</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>GetOrderItems</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Dati_Tecnici_Aziende_EE</name>
        <label>Dati Tecnici Aziende EE</label>
        <locationX>1458</locationX>
        <locationY>1790</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Bonus_Loop_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Dati_Tecnici_Aziende_GAS</name>
        <label>Dati Tecnici Aziende GAS</label>
        <locationX>1722</locationX>
        <locationY>1790</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Bonus_Loop_0</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Dati_Tecnici_Famiglie_EE</name>
        <label>Dati Tecnici Famiglie EE</label>
        <locationX>578</locationX>
        <locationY>1790</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Bonus_Loop</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Dati_Tecnici_Famiglie_GAS</name>
        <label>Dati Tecnici Famiglie GAS</label>
        <locationX>842</locationX>
        <locationY>1790</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Bonus_Loop</targetReference>
        </connector>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Durata_Contratto</name>
        <label>Durata Contratto</label>
        <locationX>490</locationX>
        <locationY>2630</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>364</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>HDT_FL_Script_Gestione_Ordini</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>HDT_FL_Script_Gestione_Ordini</name>
        <label>HDT_FL_Script_Gestione_Ordini</label>
        <locationX>490</locationX>
        <locationY>158</locationY>
        <connector>
            <targetReference>HDT_Script_Introduzione</targetReference>
        </connector>
        <flowName>HDT_FL_Script_Gestione_Ordini</flowName>
        <inputAssignments>
            <name>idOrdinePadreInput</name>
            <value>
                <elementReference>idOrdinePadreInput</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>famigliaProdottoOffertaInput</name>
            <value>
                <elementReference>offertaInput</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>HDT_Script_Anagrafica</name>
        <label>HDT Script - Anagrafica</label>
        <locationX>490</locationX>
        <locationY>398</locationY>
        <connector>
            <targetReference>Categoria_Cliente_Decision</targetReference>
        </connector>
        <flowName>HDT_Script_Anagrafica</flowName>
        <inputAssignments>
            <name>callType</name>
            <value>
                <elementReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput.LoginChannel__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>categoriaChiamata</name>
            <value>
                <elementReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput.CustomerCategory__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>OrderData</name>
            <value>
                <elementReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>ProcessTypeInput</name>
            <value>
                <stringValue>NotVas</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>HDT_Script_Introduzione</name>
        <label>HDT Script - Introduzione</label>
        <locationX>490</locationX>
        <locationY>278</locationY>
        <connector>
            <targetReference>HDT_Script_Anagrafica</targetReference>
        </connector>
        <flowName>HDT_Script_Introduzione</flowName>
        <inputAssignments>
            <name>callType</name>
            <value>
                <elementReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput.LoginChannel__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>isAxa</name>
            <value>
                <stringValue>N</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>OrderData</name>
            <value>
                <elementReference>HDT_FL_Script_Gestione_Ordini.AssignOrderPadreOutput</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>HDT_Script_VAS</name>
        <label>HDT Script - VAS</label>
        <locationX>578</locationX>
        <locationY>2414</locationY>
        <connector>
            <targetReference>Order_Items_Vas_Loop</targetReference>
        </connector>
        <flowName>HDT_Script_VAS</flowName>
        <inputAssignments>
            <name>getInputCanale</name>
            <value>
                <stringValue>Inbound</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>getInputCategoria</name>
            <value>
                <stringValue>Famiglie</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>getInputOrderId</name>
            <value>
                <elementReference>Order_Items_Vas_Loop.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>idOrdinePadreInput</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>offertaInput</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>OrdinePadre</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Order</objectType>
    </variables>
</Flow>

<template>
    <template if:true={inputParams}>
        <c-hdt-document-signature-manager params={inputParams} disable-sign-mode={disableSignMode} onconfirmdata={handleConfirmData} onpreviewexecuted={handlePreviewExecuted}></c-hdt-document-signature-manager>
    </template>
    <div class="slds-card__footer actionButtonBar slds-grid slds-grid_align-spread">
        <div class="actionsLeft">
        </div>
        <div class="actionsRight">
            <template if:true={scriptAvailable}>
                <lightning-button
                class="slds-m-top_xsmall slds-m-bottom_xsmall slds-p-left_x-small slds-float--right"
                variant="brand" type="button" name="Avvia Script" label="Avvia Script" onclick={launchScript}>
                </lightning-button>
            </template>
            <template if:true={previewExecuted}>
                <lightning-button
                class="slds-m-top_xsmall slds-m-bottom_xsmall slds-p-left_x-small slds-float--right"
                variant="brand" type="button" name="next" label={labelConfirm} onclick={handleConfirmButton}>
            </lightning-button>
            </template>
            <template if:true={showPreviewButton}>
                <lightning-button
                class="slds-m-top_xsmall slds-m-bottom_xsmall slds-p-left_x-small slds-float--right"
                variant={variantButton} type="button" name="save" label='Preview' onclick={handlePreview}>
            </lightning-button>
            </template>
        <lightning-button if:true={previousButton}
            class="slds-m-top_xsmall slds-m-bottom_xsmall slds-p-left_x-small slds-float--right"
            variant="neutral" type="button" name="previous" label="Indietro" onclick={handleGoBack}>
        </lightning-button>
            <lightning-button if:true={cancelButton} class="slds-m-top_xsmall slds-m-bottom_xsmall slds-float--right"
                variant={variantButton} type="button" name="cancel" label="Annulla" onclick={handleCancel}>
            </lightning-button>
        </div>
    </div>
    <template if:true={openModal}>
        <div class="slds-modal slds-modal_medium slds-fade-in-open slds-backdrop">
          <div class="slds-modal__container">
            <!--HEADER Section-->
            <div class="slds-modal__header">
              <lightning-button-icon icon-name="utility:close" alternative-text="Close this window" size="large"
              variant="bare-inverse" onclick={closeModal} class="slds-modal__close">
            </lightning-button-icon>
            
                <h2 class="slds-modal__title slds-hyphenate">Avvio Script</h2>
              </div>
              <!------Body Section-->
                    <div style=" max-height: 80rem !important;height: 80% !important;" class="slds-modal__content slds-var-p-around_medium slds-is-relative">
                        
                        <template if:true={isLoading}>
                            <lightning-spinner alternative-text="Loading" size="small" variant="brand"></lightning-spinner>
                        </template>
                        
                        <template if:true={flowFound}>
                            <div style="height: 500px;padding-bottom: 20px;">
                                <iframe width="100%" height="100%" src={flowUrl}></iframe>
                            </div>
                            <lightning-button variant="brand" label="Fine" title="Fine" onclick={closeModal} class="slds-m-right_x-small" disabled={isScriptNotEnded}></lightning-button>
                        </template>
    
                        <template if:false={flowFound}>
                            <p>Non Ã¨ disponibile alcuno script.</p>
                        </template>
                    </div>
                </div>
            </div>
    </template>
</template>
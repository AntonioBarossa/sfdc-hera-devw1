<template>

    <template if:true={showSpinner}>
        <div class="spinner">
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </div>
    </template>
    <div>
        <lightning-card title="Dati Catastali">
            <!-- Tabella con Button 'Nuovo' -->
            <div class="slds-grid slds-wrap">
            
                <div class="slds-size_1-of-1">
                    <!-- <template if:true={showTable}> -->
                        <lightning-datatable
                            data={tableData}
                            columns={tableColumns}
                            key-field="Id"
                            selected-rows={tableSelectedRows}
                            onrowselection={handleTableSelection}
                            max-row-selection="1">
                        </lightning-datatable>
                    <!-- </template> -->
                </div>

                <div class="slds-size_1-of-1 slds-box_x-small slds-text-align_center">
                    <lightning-button disabled={readonly} variant="brand" label="Nuovo" title="Nuovo" onclick={handleNuovoClick}></lightning-button>
                </div>
                
            </div>

            <!-- Campi -->
            <!-- <template if:true={showForm}> -->
                <lightning-record-edit-form object-api-name="LandRegistry__c" 
                                            record-id={selectedLandRegistryId} 
                                            onsubmit={handleFormSubmit}
                                            onsuccess={handleFormSuccess}
                                            onerror={handleFormError}>

                    <lightning-layout multiple-rows>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" disabled={disableForm} field-name="CodeMissingRegistryData__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="DestinationUsage__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>
                        
                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-combobox required={required}
                                                disabled={disableForm}
                                                name="RegistryCity__c"
                                                label="Comune catastale"
                                                value={registryCityValue}
                                                options={cityOptions}
                                                onchange={handleFieldChange}>
                            </lightning-combobox>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled value={registryCityCodeValue} field-name="RegistryCityCode__c"></lightning-input-field>
                        </lightning-layout-item>
                        
                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-combobox required={required}
                                                disabled={disableForm}
                                                name="LegalCity__c"
                                                label="Comune amministrativo"
                                                value={legalCityValue}
                                                options={cityOptions}
                                                onchange={handleFieldChange}>
                            </lightning-combobox>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled value={provinceValue} field-name="Province__c"></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="UnitType__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="UrbanSection__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="Sheet__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="ParticleSheet__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="Subaltern__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>
                        
                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-combobox required={required}
                                                disabled={disableForm}
                                                name="RegistryCategory__c"
                                                label="Categoria Catastale"
                                                value={cadastralCategoryValue}
                                                options={cadastralCategoryOptions}
                                                onchange={handleFieldChange}>
                            </lightning-combobox>
                        </lightning-layout-item>
                        
                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="RegistrySurface__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" required={required} disabled={disableForm} field-name="Title__c" onchange={handleFieldChange}></lightning-input-field>
                        </lightning-layout-item>

                        <lightning-layout-item size="4" padding="around-medium">
                            <lightning-input-field variant="label-stacked" disabled value={servicePointId} field-name="ServicePoint__c"></lightning-input-field>
                        </lightning-layout-item>
                        
                        <template if:false={showSalva}>
                            <lightning-layout-item size="12" padding="around-medium">
                                <div class="slds-text-align_center">
                                    <lightning-button disabled={disableModifica} label="Modifica" title="Modifica" onclick={handleModificaClick}></lightning-button>
                                </div>
                            </lightning-layout-item>
                        </template>

                        <template if:true={showSalva}>
                            <lightning-layout-item size="12" padding="around-medium">
                                <div class="slds-text-align_center">
                                    <lightning-button disabled={disableSalva} label="Salva" title="Salva" type="submit" variant="brand"></lightning-button>
                                </div>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                </lightning-record-edit-form>
            <!-- </template> -->

        </lightning-card>
    </div>
</template>